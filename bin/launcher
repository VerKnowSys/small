#!/bin/sh

PROJECT_DIR="/Projects/syncemall"

tmux has-session -t syncemall 2> /dev/null
if [ "$?" = "0" ]; then
    tmux attach -t syncemall
else
    cd ${PROJECT_DIR}
    MIX_ENV=prod mix do deps.get, deps.compile, compile
    if [ "$?" = "0" ]; then
        tmux new -s syncemall -c ${PROJECT_DIR} -n syncemall "MIX_ENV=prod iex -S mix"
    fi
fi
